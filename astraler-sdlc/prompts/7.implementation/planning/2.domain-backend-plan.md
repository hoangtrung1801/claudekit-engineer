## Prompt: Create Domain Backend Implementation Plan

**Role:**  
You are a Senior Backend Developer creating a detailed implementation plan with trackable tasks for a specific domain.

**Task:**  
I will provide you with Domain Planning, Domain TDD, and Domain Initialization documents. Create a comprehensive implementation plan document with checklist tasks for this domain's backend.

**Output:**  
A markdown document saved to `docs/7.implementation/domains/[domain-name]/backend-implementation-plan.md`

---

## Instructions

### Step 1: Identify Domain

Ask or identify from context:
- **Domain Name:** (e.g., auth, project-management, data-collection)
- **Domain Priority:** (P0, P1, P2, P3)
- **Phase:** (1, 2, 3, or 4)

### Step 2: Analyze Input Documents

Read and analyze:
1. **Domain Planning** (`docs/5.planning-setup/domains/[domain]/domain-planning.md`)
2. **Domain TDD** (`docs/3.technical-design/domains/[domain]/domain-tdd.md`)
3. **Domain Initialization** (`docs/6.initialization/domains/[domain]/domain-initialization.md`)

### Step 3: Generate Implementation Plan

Create implementation plan with:

1. **Header Section:**
   - Title: "[Domain] Backend Implementation Plan"
   - Status indicator
   - Progress counter
   - Prerequisites

2. **Implementation Tasks** by category:
   
   #### Database & Models
   - [ ] Prisma schema updates
   - [ ] Model definitions
   - [ ] Migrations
   
   #### DTOs & Validation
   - [ ] Request DTOs
   - [ ] Response DTOs
   - [ ] Validation rules
   
   #### Services
   - [ ] Business logic implementation
   - [ ] Service methods
   
   #### Controllers & Routes
   - [ ] API endpoints
   - [ ] Route handlers
   - [ ] Swagger documentation
   
   #### Guards & Middleware
   - [ ] Domain-specific guards
   - [ ] Middleware (if any)
   
   #### Tests
   - [ ] Unit tests
   - [ ] Integration tests
   - [ ] E2E tests

3. **API Endpoints Summary**
4. **Files to Create Section**
5. **Verification Checklist**

---

## Output Template

```markdown
# [Domain Name] Backend Implementation Plan

> **Domain:** [Domain Name]  
> **Status:** üî¥ Not Started  
> **Created:** [Current Date]  
> **Last Updated:** [Current Date]  
> **Progress:** 0/X tasks completed  
> **Priority:** [P0-P3]  
> **Phase:** [1-4]

---

## 1. Overview

This plan covers the backend implementation for **[Domain Name]** domain, including:
- Database schema and models
- API endpoints ([list main endpoints])
- Business logic and services
- Authentication/Authorization requirements
- Testing

**Reference Documents:**
- Domain Planning: `docs/5.planning-setup/domains/[domain]/domain-planning.md`
- Domain TDD: `docs/3.technical-design/domains/[domain]/domain-tdd.md`

**Estimated Duration:** X days  
**Dependencies:** [List dependencies on other domains]

---

## 2. Prerequisites

Before starting implementation:

- [ ] System Backend completed
- [ ] Database running
- [ ] Domain schema approved
- [ ] API contracts reviewed

---

## 3. API Endpoints Summary

| Method | Endpoint | Description | Auth |
|--------|----------|-------------|------|
| POST | `/api/v1/[domain]/...` | ... | Yes/No |
| GET | `/api/v1/[domain]/...` | ... | Yes/No |
| PUT | `/api/v1/[domain]/...` | ... | Yes/No |
| DELETE | `/api/v1/[domain]/...` | ... | Yes/No |

---

## 4. Implementation Tasks

### 4.1 Database & Models

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-DB-001 | Add domain models to Prisma schema | 2h | ‚¨ú |
| [D]-DB-002 | Create database migration | 1h | ‚¨ú |
| [D]-DB-003 | Define model relationships | 1h | ‚¨ú |
| [D]-DB-004 | Add indexes for performance | 0.5h | ‚¨ú |

**Checklist:**
- [ ] **[D]-DB-001**: Add [Domain] models to `prisma/schema.prisma`
- [ ] **[D]-DB-002**: Run `prisma migrate dev` to create migration
- [ ] **[D]-DB-003**: Define relationships with other models
- [ ] **[D]-DB-004**: Add necessary indexes

### 4.2 DTOs & Validation

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-DTO-001 | Create request DTOs | 2h | ‚¨ú |
| [D]-DTO-002 | Create response DTOs | 1h | ‚¨ú |
| [D]-DTO-003 | Add validation decorators | 1h | ‚¨ú |
| [D]-DTO-004 | Create query params DTOs | 1h | ‚¨ú |

**Checklist:**
- [ ] **[D]-DTO-001**: Create `Create[Entity]Dto`, `Update[Entity]Dto`
- [ ] **[D]-DTO-002**: Create `[Entity]ResponseDto`
- [ ] **[D]-DTO-003**: Add class-validator decorators
- [ ] **[D]-DTO-004**: Create filter/pagination DTOs

### 4.3 Services (Business Logic)

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-SVC-001 | Create [Domain]Service | 1h | ‚¨ú |
| [D]-SVC-002 | Implement create method | 2h | ‚¨ú |
| [D]-SVC-003 | Implement findAll with filters | 2h | ‚¨ú |
| [D]-SVC-004 | Implement findOne method | 1h | ‚¨ú |
| [D]-SVC-005 | Implement update method | 2h | ‚¨ú |
| [D]-SVC-006 | Implement delete method | 1h | ‚¨ú |
| [D]-SVC-007 | Implement domain-specific logic | Xh | ‚¨ú |

**Checklist:**
- [ ] **[D]-SVC-001**: Create `[domain].service.ts`
- [ ] **[D]-SVC-002**: Implement `create()` with validation
- [ ] **[D]-SVC-003**: Implement `findAll()` with pagination and filters
- [ ] **[D]-SVC-004**: Implement `findOne()` with error handling
- [ ] **[D]-SVC-005**: Implement `update()` with partial updates
- [ ] **[D]-SVC-006**: Implement `delete()` (soft delete if applicable)
- [ ] **[D]-SVC-007**: Implement domain-specific business logic

### 4.4 Controllers & Routes

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-CTL-001 | Create [Domain]Controller | 1h | ‚¨ú |
| [D]-CTL-002 | Implement POST endpoint | 1h | ‚¨ú |
| [D]-CTL-003 | Implement GET (list) endpoint | 1h | ‚¨ú |
| [D]-CTL-004 | Implement GET (single) endpoint | 0.5h | ‚¨ú |
| [D]-CTL-005 | Implement PUT/PATCH endpoint | 1h | ‚¨ú |
| [D]-CTL-006 | Implement DELETE endpoint | 0.5h | ‚¨ú |
| [D]-CTL-007 | Add Swagger documentation | 1h | ‚¨ú |

**Checklist:**
- [ ] **[D]-CTL-001**: Create `[domain].controller.ts`
- [ ] **[D]-CTL-002**: POST `/api/v1/[domain]` - Create
- [ ] **[D]-CTL-003**: GET `/api/v1/[domain]` - List with filters
- [ ] **[D]-CTL-004**: GET `/api/v1/[domain]/:id` - Get single
- [ ] **[D]-CTL-005**: PATCH `/api/v1/[domain]/:id` - Update
- [ ] **[D]-CTL-006**: DELETE `/api/v1/[domain]/:id` - Delete
- [ ] **[D]-CTL-007**: Add @ApiTags, @ApiOperation, @ApiResponse

### 4.5 Module Setup

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-MOD-001 | Create [Domain]Module | 0.5h | ‚¨ú |
| [D]-MOD-002 | Register in AppModule | 0.5h | ‚¨ú |
| [D]-MOD-003 | Export services if needed | 0.5h | ‚¨ú |

**Checklist:**
- [ ] **[D]-MOD-001**: Create `[domain].module.ts` with providers
- [ ] **[D]-MOD-002**: Import [Domain]Module in app.module.ts
- [ ] **[D]-MOD-003**: Export services for other modules

### 4.6 Guards & Middleware (if applicable)

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-GRD-001 | Apply auth guards to routes | 1h | ‚¨ú |
| [D]-GRD-002 | Apply role guards if needed | 1h | ‚¨ú |
| [D]-GRD-003 | Create domain-specific guards | 2h | ‚¨ú |

**Checklist:**
- [ ] **[D]-GRD-001**: Apply @UseGuards(JwtAuthGuard) to protected routes
- [ ] **[D]-GRD-002**: Apply @Roles() decorator for RBAC
- [ ] **[D]-GRD-003**: Create ownership/permission guards if needed

### 4.7 Tests

| ID | Task | Est. | Status |
|----|------|------|--------|
| [D]-TST-001 | Write service unit tests | 3h | ‚¨ú |
| [D]-TST-002 | Write controller unit tests | 2h | ‚¨ú |
| [D]-TST-003 | Write E2E tests | 3h | ‚¨ú |

**Checklist:**
- [ ] **[D]-TST-001**: Unit tests for [Domain]Service
- [ ] **[D]-TST-002**: Unit tests for [Domain]Controller
- [ ] **[D]-TST-003**: E2E tests for all endpoints

---

## 5. Files to Create/Modify

```
backend/src/modules/[domain]/
‚îú‚îÄ‚îÄ [domain].module.ts           # Module definition
‚îú‚îÄ‚îÄ [domain].controller.ts       # API endpoints
‚îú‚îÄ‚îÄ [domain].service.ts          # Business logic
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ create-[entity].dto.ts   # Create DTO
‚îÇ   ‚îú‚îÄ‚îÄ update-[entity].dto.ts   # Update DTO
‚îÇ   ‚îú‚îÄ‚îÄ [entity]-response.dto.ts # Response DTO
‚îÇ   ‚îî‚îÄ‚îÄ [entity]-query.dto.ts    # Query params DTO
‚îú‚îÄ‚îÄ entities/                    # (if using TypeORM-style)
‚îÇ   ‚îî‚îÄ‚îÄ [entity].entity.ts
‚îú‚îÄ‚îÄ guards/                      # (if domain-specific guards)
‚îÇ   ‚îî‚îÄ‚îÄ [domain].guard.ts
‚îî‚îÄ‚îÄ tests/
    ‚îú‚îÄ‚îÄ [domain].service.spec.ts
    ‚îú‚îÄ‚îÄ [domain].controller.spec.ts
    ‚îî‚îÄ‚îÄ [domain].e2e-spec.ts

prisma/
‚îú‚îÄ‚îÄ schema.prisma                # Add models
‚îî‚îÄ‚îÄ migrations/
    ‚îî‚îÄ‚îÄ [timestamp]_add_[domain]/
        ‚îî‚îÄ‚îÄ migration.sql
```

---

## 6. Verification Checklist

After completing all tasks:

- [ ] All [D]-XXX tasks marked as completed
- [ ] Prisma migration applied successfully
- [ ] All API endpoints working (test with Postman/Swagger)
- [ ] Authentication/Authorization working
- [ ] Swagger documentation complete
- [ ] Unit tests passing
- [ ] E2E tests passing
- [ ] No TypeScript/ESLint errors
- [ ] Code reviewed

---

## 7. Notes & Issues

### Implementation Notes
- [Space for notes during implementation]

### Issues Encountered
- [Space for documenting issues]

### Decisions Made
- [Space for architectural decisions]

---

## 8. Progress Log

| Date | Tasks Completed | Notes |
|------|-----------------|-------|
| | | |

---

**Next Step:** After completing [Domain] Backend, proceed to [Domain] Frontend Planning.
```

---

## Variable Replacements

When generating the plan, replace these placeholders:

| Placeholder | Description | Example |
|-------------|-------------|---------|
| `[Domain Name]` | Human-readable domain name | "Auth", "Project Management" |
| `[domain]` | Lowercase, kebab-case | "auth", "project-management" |
| `[D]` | Short domain prefix for task IDs | "AUTH", "PM", "DC" |
| `[Entity]` | Main entity name | "User", "Project", "Competitor" |
| `[entity]` | Lowercase entity | "user", "project", "competitor" |

---

## Principles

1. **Follow Domain TDD:** Tasks should match TDD specifications
2. **CRUD First:** Implement basic CRUD before complex logic
3. **Test Coverage:** Include tests for all business logic
4. **API Documentation:** Swagger docs for all endpoints
5. **Consistent IDs:** Use domain prefix for task IDs

---

## üìÅ Output Path

Save the generated plan to:

```
docs/7.implementation/domains/[domain-name]/backend-implementation-plan.md
```

**Example paths:**
- `docs/7.implementation/domains/auth/backend-implementation-plan.md`
- `docs/7.implementation/domains/project-management/backend-implementation-plan.md`

**Notes:**
- Create folder structure if it doesn't exist
- Replace `[domain-name]` with actual domain name (kebab-case)

