## Prompt: Level 3 - Feature TDD

**Role:**  
You are a Full-Stack Solution Architect specialized in implementation. You have the ability to design in detail a specific feature with enough information for developers to code immediately.

**Task:**  
I will provide you with:
- Domain/Module TDD (already available from Level 2)
- PRD section for specific feature
- User stories and acceptance criteria for this feature

Create a **Feature TDD** - a detailed technical design document for this feature, sufficient for developers to start implementation.

**Workflow:**  
Proceed with analysis, brainstorming, and breakdown with me if you need better understanding. Then proceed with the Feature TDD process.

---

## Feature TDD Requirements:

### 1. **Feature Overview**
   - **Feature Name & ID:**
     - Feature name and unique identifier
     - Link to Domain TDD and System Overview TDD
   - **Feature Description:**
     - Detailed description of what this feature does
     - Business value and user benefits
   - **User Stories:**
     - All user stories related to this feature
     - Acceptance criteria for each story
   - **Feature Scope:**
     - What belongs and doesn't belong to this feature
     - Out of scope items

### 2. **User Flow & UI Design**
   - **User Flow Diagram:**
     - Detailed user journey flow chart
     - Happy path and alternative paths
     - Error scenarios
   - **Screen/Page Design:**
     - List of screens/pages in feature
     - Detailed layout and component description for each screen
     - Wireframes or detailed UI description
   - **Component Design:**
     - Component hierarchy
     - Props and state for each component
     - Component interactions
   - **State Management:**
     - State structure for this feature
     - Actions and reducers (if using Redux)
     - Local state vs global state

### 3. **API Design - Detailed**
   - **API Endpoints:**
     - **Endpoint 1:**
       - Method: GET/POST/PUT/DELETE/PATCH
       - Path: `/api/v1/...`
       - Description: Function description
       - **Request:**
         - Headers: Authorization, Content-Type, etc.
         - Query params: (if GET)
         - Request body: Detailed schema with examples
       - **Response:**
         - Success response: Schema + example
         - Error responses: All error cases with codes and messages
       - **Authentication:** Required/Optional
       - **Authorization:** Roles/permissions required
       - **Rate Limiting:** (if any)
     - **Endpoint 2:** (repeat format above)
     - ...
   - **API Contracts:**
     - Request/Response schemas (JSON Schema or TypeScript types)
     - Validation rules
     - Standard error codes and messages
   - **API Integration:**
     - Which APIs this calls from other domains
     - Error handling when calling external APIs

### 4. **Database Changes**
   - **New Tables:**
     - Detailed schema: table name, columns, types, constraints
     - Required indexes
     - Foreign keys
   - **Table Modifications:**
     - Columns added/modified/deleted
     - Indexes added/removed
     - Constraints changed
   - **Migration Scripts:**
     - Up migration: SQL or migration code
     - Down migration: Rollback script
     - Data migration: If data needs to be migrated
   - **Seed Data:**
     - Seed data required for feature
   - **Query Design:**
     - Main queries this feature will use
     - Query optimization notes

### 5. **Business Logic & Algorithms**
   - **Business Rules:**
     - All detailed business rules
     - Validation logic
     - Calculation formulas (if any)
   - **Algorithm Design:**
     - Complex algorithms (if any)
     - Pseudocode or flow chart
     - Time/space complexity (if important)
   - **Workflow Logic:**
     - Step-by-step workflow
     - State transitions
     - Decision points and conditions
   - **Edge Cases:**
     - All edge cases to handle
     - Boundary conditions

### 6. **Error Handling**
   - **Error Scenarios:**
     - All possible error cases
     - Error codes and messages
     - User-friendly error messages
   - **Error Handling Flow:**
     - How to handle errors at each layer
     - Error propagation
     - Retry logic (if any)
   - **Validation:**
     - Input validation rules
     - Business validation rules
     - Validation error messages

### 7. **Security Considerations**
   - **Authentication:**
     - Authentication requirements for feature
     - Token validation
   - **Authorization:**
     - Required roles/permissions
     - Where authorization checks happen
     - RBAC rules
   - **Data Security:**
     - Sensitive data handling
     - Encryption requirements
     - PII protection (if any)
   - **Input Sanitization:**
     - XSS prevention
     - SQL injection prevention
     - Input sanitization rules

### 8. **Performance Considerations**
   - **Performance Requirements:**
     - Response time targets
     - Throughput requirements
   - **Optimization Strategies:**
     - Caching opportunities
     - Database query optimization
     - Lazy loading (if frontend)
   - **Bottlenecks:**
     - Potential bottlenecks
     - Mitigation strategies

### 9. **Testing Strategy**
   - **Unit Tests:**
     - Test cases to write
     - Key functions/methods to test
     - Mock strategies
   - **Integration Tests:**
     - Integration test scenarios
     - API endpoint tests
     - Database integration tests
   - **E2E Tests:**
     - E2E test scenarios
     - User flow tests
   - **Test Data:**
     - Required test fixtures
     - Test users and permissions
   - **Test Coverage Goal:**
     - Coverage target (e.g., >80%)

### 10. **Implementation Checklist**
    - **Frontend Tasks:**
      - [ ] Create components
      - [ ] Implement state management
      - [ ] Add routing
      - [ ] Implement API calls
      - [ ] Add error handling
      - [ ] Add loading states
      - [ ] Add validation
      - [ ] Styling and responsive design
      - [ ] Accessibility improvements
    - **Backend Tasks:**
      - [ ] Create API endpoints
      - [ ] Implement business logic
      - [ ] Add database migrations
      - [ ] Add validation
      - [ ] Add error handling
      - [ ] Add logging
      - [ ] Add authentication/authorization
      - [ ] Write unit tests
      - [ ] Write integration tests
    - **Database Tasks:**
      - [ ] Create migration scripts
      - [ ] Add indexes
      - [ ] Add constraints
      - [ ] Create seed data
      - [ ] Test migrations
    - **DevOps Tasks:**
      - [ ] Update CI/CD pipeline (if needed)
      - [ ] Update monitoring (if needed)
      - [ ] Update documentation

### 11. **Dependencies & Prerequisites**
    - **Dependencies:**
      - Other features that must be completed first
      - APIs from other domains that must be available
      - Infrastructure requirements
    - **Prerequisites:**
      - Database migrations to run first
      - Configurations to setup
      - Third-party services to integrate

### 12. **Documentation Requirements**
    - **API Documentation:**
      - OpenAPI/Swagger spec
      - Postman collection (if any)
    - **Code Documentation:**
      - Required code comments
      - JSDoc/TSDoc for functions
    - **User Documentation:**
      - User guide (if needed)
      - Admin guide (if needed)

---

## Principles:

- **Implementation-ready:** Detailed enough for developers to code immediately without asking many questions
- **Specific:** Specific about APIs, database, components - not vague
- **Complete:** Cover all aspects: frontend, backend, database, testing
- **Traceable:** Clear link to Domain TDD and System Overview TDD
- **Practical:** Focus on what's needed to implement this feature

---

## üìÅ Output Path:

After creating Feature TDD, save file to:

```
docs/3.technical-design/domains/[domain-name]/features/[feature-name]/feature-tdd.md
```

**Notes:** 
- Replace `[domain-name]` with actual domain name (lowercase, kebab-case)
- Replace `[feature-name]` with actual feature name (lowercase, kebab-case)
- Create `docs/3.technical-design/domains/[domain-name]/features/[feature-name]` folder if it doesn't exist
- File name: `feature-tdd.md` (lowercase, kebab-case)
- Example: `docs/3.technical-design/domains/user-management/features/user-registration/feature-tdd.md`

---

## Expected Output:

A clear, detailed **Feature TDD** including:

1. ‚úÖ Detailed user flow and UI design
2. ‚úÖ Complete API endpoints with request/response schemas
3. ‚úÖ Database changes with migration scripts
4. ‚úÖ Detailed business logic and algorithms
5. ‚úÖ Error handling and edge cases
6. ‚úÖ Security and performance considerations
7. ‚úÖ Testing strategy with specific test cases
8. ‚úÖ Detailed implementation checklist
9. ‚úÖ Sufficient information for developers to start coding immediately

**Note:** This document must be detailed enough for:
- Developers to implement without asking many questions
- QA to write test cases based on it
- Code reviewers to review code based on this design
- Product Owner to validate feature meets requirements
