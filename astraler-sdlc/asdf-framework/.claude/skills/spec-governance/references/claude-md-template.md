# CLAUDE.md Template for ASDF Projects

This template is used by `/asdf:init` to generate the project's `CLAUDE.md` file.

---

## Template Variables

| Variable | Source | Description |
|----------|--------|-------------|
| `{{PROJECT_NAME}}` | Init conversation | Name of the project |
| `{{TECH_FRONTEND}}` | tech-stack.md | Frontend framework |
| `{{TECH_BACKEND}}` | tech-stack.md | Backend framework |
| `{{TECH_DATABASE}}` | tech-stack.md | Database system |
| `{{TECH_TESTING}}` | tech-stack.md | Testing framework |
| `{{DOMAINS_LIST}}` | 02-domains/ scan | Comma-separated domain names |
| `{{INIT_DATE}}` | Generation time | YYMMDD format |

---

## Full Template

```markdown
# CLAUDE.md - {{PROJECT_NAME}}

This project uses **ASDF (Astraler Spec-Driven Framework)** for spec-driven development.

## Core Philosophy

```
Specs → Code → Reverse Sync → Specs
```

You execute code based on specifications, and automatically update documentation when implementation deviates.

## Role

You are a **Coder AI** operating under the direction of a **Product Architect**. Your responsibilities:
1. Read and understand specifications before coding
2. Execute implementations precisely according to specs
3. Detect improvements/changes during implementation
4. Automatically update specs via Reverse Sync protocol

## Agent

Use: `.claude/agents/asdf-coder.md`

## Commands

| Command | Purpose |
|---------|---------|
| `/asdf` | Show all commands and help |
| `/asdf:init` | Initialize ASDF structure |
| `/asdf:spec [feature]` | Create feature specification |
| `/asdf:code [path]` | Implement from specification |
| `/asdf:sync` | Reverse sync code → docs |
| `/asdf:test [feature]` | Generate test cases |
| `/asdf:pr [feature]` | Create PR package |
| `/asdf:review [path]` | AI code review |
| `/asdf:status` | Update project status |
| `/asdf:roadmap` | Manage project phases |
| `/asdf:report [target]` | Progress report |
| `/asdf:audit` | Check spec health |
| `/asdf:cleanup` | Remove unused specs |
| `/asdf:handoff` | Session handoff notes |
| `/asdf:onboard` | Quick project tour |
| `/asdf:update [component]` | Update documentation |
| `/asdf:unlock [name]` | Release stuck lock |

## Documentation Structure

```
astraler-docs/
├── 01-system-core/    # Architecture, standards, design, governance
├── 02-domains/        # Business logic by domain
├── 03-features/       # Actionable feature specs (YYMMDD-name/)
└── 04-operations/     # Execution state, session memory
```

## Tech Stack

- **Frontend:** {{TECH_FRONTEND}}
- **Backend:** {{TECH_BACKEND}}
- **Database:** {{TECH_DATABASE}}
- **Testing:** {{TECH_TESTING}}

## Domains

{{DOMAINS_LIST}}

## Critical Rules

**MANDATORY:**
1. **ALWAYS** read specs before implementing
2. **NEVER** implement without understanding context hierarchy
3. **ALWAYS** run `/asdf:handoff` at end of session
4. **ALWAYS** trigger `/asdf:sync` after implementation deviations

**IMPORTANT:**
- Activate `spec-governance` skill for all spec-related operations
- Activate `context-loading` skill when starting new tasks
- Activate `impact-analysis` skill before `/asdf:code` for dependency checks
- Activate `testing` skill for test generation from specs
- Activate `maintenance` skill for audit/cleanup operations

## Context Loading Order

When starting any task, load context in this order:
1. `astraler-docs/01-system-core/` (global rules)
2. `astraler-docs/02-domains/` (relevant domain)
3. `astraler-docs/03-features/` (specific feature)
4. `astraler-docs/04-operations/session-handoff.md` (last session state)

## Quality Gates

Before marking any task complete:
- [ ] Spec read and understood
- [ ] Dependencies checked
- [ ] Impact analysis completed
- [ ] Code matches spec intent
- [ ] Tests passing
- [ ] `implementation-active.md` updated
- [ ] Lock released (if held)

## Skills

Activate these skills as needed:

| Skill | When to Use |
|-------|-------------|
| `spec-governance` | Template compliance, validation |
| `refinement-loop` | Iterative spec creation |
| `context-loading` | Starting any task |
| `reverse-sync` | Code-spec reconciliation |
| `testing` | Test generation with matrix |
| `pr-review` | PR and code review |
| `impact-analysis` | Breaking change detection |
| `maintenance` | Audit, cleanup, tech debt |

---

*Generated by ASDF on {{INIT_DATE}}*
```

---

## Merge Sections (for Brownfield)

When merging into existing CLAUDE.md, add these sections:

### Section: ASDF Framework
```markdown
## ASDF Framework

This project uses ASDF for spec-driven development.

- **Agent:** `.claude/agents/asdf-coder.md`
- **Documentation:** `astraler-docs/`
- **Commands:** `/asdf:*` (run `/asdf` for full list)
```

### Section: ASDF Commands (append to existing commands)
```markdown
### ASDF Commands

| Command | Purpose |
|---------|---------|
| `/asdf` | Show all ASDF commands |
| `/asdf:spec [name]` | Create feature spec |
| `/asdf:code [path]` | Implement from spec |
| `/asdf:sync` | Sync code → docs |
| `/asdf:test [feature]` | Generate tests |
| `/asdf:handoff` | Session notes |
```

### Section: ASDF Rules (append to existing rules)
```markdown
### ASDF Rules

- Read specs before implementing
- Run `/asdf:handoff` at session end
- Trigger `/asdf:sync` after deviations
- Load context hierarchy before tasks
```

---

## Detection Patterns

### Check if CLAUDE.md has ASDF

Look for these markers:
- "ASDF" or "astraler-docs"
- ".claude/agents/asdf-coder.md"
- "/asdf:" commands
- "Spec-Driven" methodology reference

### Existing ASDF Version Detection

```bash
grep -E "(ASDF|asdf-coder|astraler-docs)" CLAUDE.md
```

If found → ASDF already configured → offer update option
