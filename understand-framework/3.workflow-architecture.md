# Kiến trúc Quy trình làm việc (Workflow)

Framework `claudekit-engineer` tuân thủ một quy trình làm việc nghiêm ngặt, dựa trên tài liệu nhằm đảm bảo sự phối hợp giữa các agent và tính minh bạch cho nhà phát triển (con người).

## Vòng lặp Kỹ thuật Chính

Hệ thống vận hành theo cơ chế "Chain of Agents", nơi mỗi kết quả của agent trước là đầu vào cho agent sau.

```mermaid
graph TD
    User([Yêu cầu từ Người dùng]) --> PM[Project Manager: Phân tích & Điều hướng]
    PM --> Planner[Planner: Nghiên cứu & Thiết kế]
    
    subgraph Planning [Giai đoạn Lập kế hoạch]
        Planner --> R1[Researcher: Công nghệ A]
        Planner --> R2[Researcher: Công nghệ B]
        R1 & R2 --> Planner
        Planner --> PlanFile[(Kế hoạch: ./plans/YYMMDD-plan.md)]
    end
    
    PlanFile --> Coder[Main AI Agent: Triển khai]
    
    subgraph Execution [Giai đoạn Thực thi]
        Coder --> Build[Chạy Biên dịch/Build]
        Build -- Lỗi --> Coder
        Build -- Thành công --> Tester[Tester Agent: Chạy Kiểm thử]
        Tester -- Thất bại --> Coder
    end
    
    Tester -- Vượt qua --> Reviewer[Code Reviewer: Kiểm tra]
    Reviewer -- Gợi ý --> Coder
    Reviewer -- Phê duyệt --> Docs[Docs Manager: Cập nhật tài liệu]
    
    Docs --> Git[Git Manager: Commit & Push]
    Git --> Done([Hoàn tất tính năng])

    style PlanFile fill:#f9f,stroke:#333,stroke-width:4px
    style Planning fill:#e1f5fe,stroke:#01579b
    style Execution fill:#fff3e0,stroke:#e65100
```

## Công cụ (Tools) & Kỹ năng (Skills) hỗ trợ

Trong mỗi bước, các agent sử dụng các MCP server mạnh mẽ để mở rộng khả năng:

- **Khám phá mã nguồn**: `grep`, `fd`, `view_file_outline`.
- **Nghiên cứu tài liệu**: `context7` (đọc API docs), `search_google`, `review-website` (chuyển HTML sang Markdown).
- **Phân tích hình ảnh**: `ai-multimodal` (cho UI/UX).
- **Tư duy phản biện**: `sequential-thinking` (chia nhỏ vấn đề phức tạp thành các bước tư duy tuần tự).

## Mô hình Giao tiếp dựa trên Tệp (File-based AI Communication)

Các agent giao tiếp chủ yếu thông qua hệ thống tệp tin thay vì chỉ chat, giúp bảo tồn context:

1.  **Shared Memory**: File `task.md` trong thư mục artifacts lưu trạng thái hiện tại của toàn bộ process.
2.  **Handoff Reports**: Các report được lưu lại với định dạng: `YYMMDD-from-agent-A-to-agent-B-task-report.md`.
3.  **Audit Trail**: Mọi quyết định được ghi lại trong `./plans/`, giúp con người có thể "quay ngược thời gian" để hiểu tại sao một tính năng được triển khai theo cách đó.

## Các Nguyên tắc Phát triển (The Golden Rules)

Framework thực thi các nguyên tắc này thông qua `development-rules.md`:
1.  **KISS & YANGI**: Code Reviewer sẽ từ chối các đoạn mã quá phức tạp hoặc "làm trước cho tương lai".
2.  **File Size Limit**: Tự động cảnh báo nếu file vượt quá 200 dòng để duy trì tính mô-đun.
3.  **Real Code Only**: Tuyệt đối không sử dụng mock data hoặc simulation trừ khi không còn cách nào khác.
