# Deep Dive: Bên dưới nắp capo (Internal Mechanics)

Nếu bạn muốn tùy chỉnh framework hoặc hiểu sâu về cách nó vận hành, đây là những khu vực quan trọng nhất.

## 1. Cấu trúc .claude/ - "Bộ não điều khiển"

Thư mục này chứa các chỉ dẫn (instructions) mà Claude Code sẽ đọc mỗi khi bắt đầu phiên làm việc:

-   **`workflows/`**: Chứa các quy trình chuẩn (SOP). Nếu bạn muốn đổi quy trình review, hãy sửa `code-reviewer.md` ở đây.
-   **`skills/`**: (Nếu có) Chứa các định nghĩa về MCP skills hoặc các hàm helper.
-   **`settings.json`**: Cấu hình môi trường cho các agent.

## 2. Cấu trúc .opencode/agent/ - "Định nghĩa Nhân sự"

Đây là nơi bạn "thuê" các agent. Mỗi file `.md` ở đây là một **System Prompt** thu nhỏ cho một vai trò cụ thể:

-   Mỗi agent thường có:
    -   **Name & Description**: Để AI biết khi nào nên gọi agent này.
    -   **Core Responsibilities**: Danh sách các nhiệm vụ cụ thể.
    -   **Working Process**: Các bước agent sẽ thực hiện.
    -   **Output Format**: Định dạng bắt buộc của kết quả (thường là Markdown).

## 3. Thư mục plans/ - "Shared Memory"

Đây là trung tâm điều phối của dự án.
-   Mọi cuộc hội thoại AI có thể bị giới hạn context, nhưng các file trong `./plans/` là **vĩnh viễn**.
-   **Hệ thống phân cấp**:
    -   `./plans/YYMMDD-feature/`: Thư mục cho một tính năng lớn.
    -   `./plans/YYMMDD-feature/research/`: Các kết quả tìm kiếm từ agent `researcher`.
    -   `./plans/YYMMDD-feature/reports/`: Các báo cáo từ `tester` hoặc `code-reviewer`.

## 4. CLAUDE.md - "Hiến pháp"

File này nằm ở root và là file đầu tiên Claude Code đọc. Nó hoạt động như một bộ khung pháp lý:
-   Nó quy định Claude *phải* dùng agent nào cho việc gì.
-   Nó ép buộc Claude *phải* đọc `README.md` và tuân thủ `development-rules.md`.
-   **Lưu ý**: Đừng bao giờ xóa các dòng "IMPORTANT" trong file này, vì đó là những "mỏ neo" giữ cho AI không đi chệch hướng.

## 5. Cơ chế Tooling (MCP)

Framework này tận dụng tối đa **Model Context Protocol (MCP)**:
-   Nó không chỉ đọc file, nó còn có thể:
    -   Dùng `search_google` để cập nhật công nghệ mới nhất (vượt qua giới hạn ngày cắt data của LLM).
    -   Dùng `imagemagick` hoặc `multimodal` để xử lý file đồ họa.
    -   Dùng `bash` để chạy lệnh terminal thật sự, đảm bảo code không chỉ "trông có vẻ đúng" mà phải "chạy đúng".

---

### Kết luận
`claudekit-engineer` không chỉ là một công cụ lập trình, nó là một **môi trường cộng tác giữa AI và Con người**. Nó biến AI từ một "chatbot" thành một "thành viên đội ngũ" có kỷ luật, có quy trình và có bộ nhớ dài hạn.
